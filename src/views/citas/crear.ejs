<%- include('../layout', { body: `
<div class="max-w-2xl mx-auto">
  <div class="bg-white rounded-xl shadow-sm p-6">
    ${error ? '<div class="bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg mb-6"><i class="fas fa-exclamation-circle mr-2"></i>' + error + '</div>' : ''}

    <form action="/citas/crear" method="POST" class="space-y-6">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Paciente *</label>
        <select name="pacienteId" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500">
          <option value="">Seleccionar paciente</option>
          ${pacientes.map(p => '<option value="' + p.id + '">' + p.nombre + ' ' + p.apellido + ' - ' + (p.telefono || 'Sin tel') + '</option>').join('')}
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Doctor *</label>
        <select name="doctorId" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500">
          <option value="">Seleccionar doctor</option>
          ${doctores.map(d => '<option value="' + d.id + '" ' + (doctorId == d.id ? 'selected' : '') + '>Dr. ' + d.nombre + ' ' + d.apellido + ' - ' + d.especialidad + '</option>').join('')}
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Consultorio</label>
        <select name="consultorioId" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500">
          <option value="">Sin asignar</option>
          ${consultorios.map(c => '<option value="' + c.id + '">' + c.nombre + '</option>').join('')}
        </select>
      </div>

      <div class="grid md:grid-cols-3 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Fecha *</label>
          <input type="date" name="fecha" required value="${fecha}"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Hora Inicio *</label>
          <input type="time" name="horaInicio" required value="${hora}"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Hora Fin *</label>
          <input type="time" name="horaFin" required value=""
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500">
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Motivo de la cita</label>
        <textarea name="motivo" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500" placeholder="Describe el motivo de la cita..."></textarea>
      </div>

      <div class="flex justify-end gap-4">
        <a href="/citas" class="px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition">Cancelar</a>
        <button type="submit" class="bg-primary-600 text-white px-6 py-2 rounded-lg hover:bg-primary-700 transition">
          <i class="fas fa-calendar-plus mr-2"></i> Agendar Cita
        </button>
      </div>
    </form>
  </div>
</div>
`}) %>

